# CSV作品播放器

一个专为CSV作品数据设计的播放器应用程序，支持导入CSV文件，显示作品列表，并可点击播放查看视频作品。

## 功能特性

- 📁 **CSV文件导入**: 支持导入包含作品信息的CSV文件
- 📋 **作品列表显示**: 清晰展示作品名称、参赛者、组别、指导老师等信息
- 🎥 **视频播放**: 点击作品即可在线播放视频
- 🔍 **智能搜索**: 支持按作品名称、参赛者姓名等关键词搜索
- 🌐 **浏览器打开**: 支持在默认浏览器中打开视频链接
- 💻 **跨平台支持**: 支持Windows和macOS系统

## 系统要求

- Python 3.8+
- PyQt5
- 网络连接（用于播放在线视频）

## 安装和运行

### 方法一：从源码运行

1. 克隆或下载项目文件
2. 安装依赖：
```bash
pip install -r requirements.txt
```

3. 运行程序：
```bash
python main.py
```

### 方法二：下载预编译版本

从[Releases页面](../../releases)下载适合您系统的预编译版本：
- Windows: `CSV作品播放器.exe`
- macOS: `CSV作品播放器.dmg`

## 使用说明

### 1. 导入CSV文件

点击"📁 导入CSV文件"按钮，选择包含作品信息的CSV文件。

**CSV文件格式要求：**
CSV文件应包含以下列（列名需完全匹配）：
- `作品名称`: 作品的名称
- `身份证名字`: 参赛者姓名
- `参赛者组别`: 参赛组别（如：大学生组、社会组等）
- `指导老师`: 指导老师姓名
- `推送单位学校`: 推送单位或学校名称
- `资料链接`: 视频文件的URL链接
- `联系电话`: 联系电话（可选）

### 2. 浏览作品列表

导入成功后，所有作品将显示在左侧的表格中。您可以：
- 点击表头对作品进行排序
- 使用顶部搜索框快速查找特定作品
- 单击选中作品查看详细信息

### 3. 播放视频

有多种方式播放视频：
- **双击表格行**: 直接双击任意作品行
- **选中后点击播放按钮**: 先选中作品，然后点击"▶️ 播放选中作品"按钮
- **在浏览器中打开**: 点击"🔗 在浏览器中打开"在默认浏览器中播放

### 4. 视频播放控制

右侧视频播放器提供以下控制：
- ▶️/⏸️ 播放/暂停
- ⏹️ 停止播放
- 显示下载进度（首次播放时）

## 技术架构

- **界面框架**: PyQt5
- **视频播放**: QMediaPlayer
- **网络请求**: requests
- **多线程下载**: QThread
- **打包工具**: PyInstaller

## 开发和构建

### 本地开发

```bash
# 安装开发依赖
pip install -r requirements.txt

# 运行程序
python main.py
```

### 构建可执行文件

**Windows:**
```bash
pyinstaller --onefile --windowed --name="CSV作品播放器" main.py
```

**macOS:**
```bash
pyinstaller --onefile --windowed --name="CSV作品播放器" main.py
```

### 自动化构建

项目配置了GitHub Actions自动构建流程，每次推送代码或创建Release时会自动构建Windows和macOS版本。

## 项目结构

```
├── main.py                 # 主程序文件
├── requirements.txt        # Python依赖
├── .github/
│   └── workflows/
│       └── build.yml      # GitHub Actions构建配置
├── .gitignore             # Git忽略文件
└── README.md              # 说明文档
```

## 故障排除

### 常见问题

1. **视频无法播放**
   - 检查网络连接是否正常
   - 确认视频链接是否有效
   - 某些视频格式可能不被支持

2. **CSV导入失败**
   - 检查CSV文件编码是否为UTF-8
   - 确认列名是否完全匹配要求的格式
   - 检查CSV文件是否存在格式错误

3. **程序启动失败**
   - 确认Python版本是否为3.8+
   - 检查是否正确安装了所有依赖包
   - 在命令行中运行查看详细错误信息

### 日志和调试

程序运行时的状态信息会显示在底部状态栏中。如遇到问题，请查看控制台输出的详细错误信息。

## 许可证

本项目采用MIT许可证，详情请查看LICENSE文件。

## 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 更新日志

### v1.0.0
- 初始版本发布
- 支持CSV文件导入和作品列表显示
- 支持在线视频播放
- 支持作品搜索和信息查看
- 支持Windows和macOS自动构建
